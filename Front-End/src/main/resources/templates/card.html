<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Cards Dashboard</title>
    <!-- Include Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Add CSS styles for your card design here -->
    <link rel="stylesheet" th:href="@{/static/css/card-style.css}" type="text/css">
    <link href="/static/img/my_logo.png" rel="icon" type="image/png"/>
</head>
<body>
<h1>Cards Dashboard</h1>
<div class="header">
    <!-- View All Cards Section -->
    <h2>View All Cards</h2>
    <button class="add-btn" type="button" data-toggle="modal" data-target="#addCardModal"> Add Card</button>

</div>

<!-- Add New Card Modal -->
<div class="modal fade" id="addCardModal" tabindex="-1" role="dialog" aria-labelledby="addCardModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <!-- Form fields for adding a card -->
                <form class="form" action="/card-new" method="post">
                    <p>Card</p>
                    <div class="container-1">
                    <div class="group">
                        <input required="true" class="main-input" type="text" name="name">
                        <span class="highlight-span"></span>
                        <label class="lebal-email">Name</label>
                    </div></div>
                    <div class="container-1">
                    <div class="group">
                        <input required="true" class="main-input" type="text" name="description">
                        <span class="highlight-span"></span>
                        <label class="lebal-email">Description</label>
                    </div></div>
                    <div class="container-1">
                    <div class="group">
                        <input required="true" class="main-input" type="text" name="color">
                        <span class="highlight-span"></span>
                        <label class="lebal-email">Color</label>
                    </div></div>

                    <div class="container-1">
                    <div class="group">
                        <select name="status" >
                            <option value="TO_DO">To Do</option>
                            <option value="IN_PROGRESS">In Progress</option>
                            <option value="DONE">Done</option>
                        </select>
                    </div> </div>

                    <div class="row">
                    <button type="submit" class="submit" >submit</button>
                    <button type="reset" class="submit" >clear</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!--Update Card Modal-->
<div class="modal fade" id="updateCardModal" tabindex="-1" role="dialog" aria-labelledby="updateCardModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <!-- Form fields for adding a card -->
                <form class="form" action="/card-update" method="post">
                    <p>Card</p>
                    <div class="container-1">
                        <input required="true" class="main-input" type="hidden" id="id" name="id">
                        <div class="group">
                            <input required="true" class="main-input" type="text" id="name" name="name">
                            <span class="highlight-span"></span>
                            <label class="lebal-email">Name</label>
                        </div></div>
                    <div class="container-1">
                        <div class="group">
                            <input required="true" class="main-input" type="text" id="description" name="description">
                            <span class="highlight-span"></span>
                            <label class="lebal-email">Description</label>
                        </div></div>
                    <div class="container-1">
                        <div class="group">
                            <input required="true" class="main-input" type="text" id="color" name="color">
                            <span class="highlight-span"></span>
                            <label class="lebal-email">Color</label>
                        </div></div>

                    <div class="container-1">
                        <div class="group">
                            <select name="status" id="status" >
                                <option value="TO_DO">To Do</option>
                                <option value="IN_PROGRESS">In Progress</option>
                                <option value="DONE">Done</option>
                            </select>
                        </div> </div>

                    <div class="row">
                        <button type="submit" class="submit" >submit</button>
                        <button type="reset" class="submit" >clear</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="deleteCardModal" tabindex="-1" role="dialog" aria-labelledby="deleteCardModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <!-- Form fields for adding a card -->
                <form class="form" action="/card-delete" method="post">
                    <p>Are you sure you want to delete card id :?</p>
                    <div class="container-1">

                        <div class="group">
                            <input required="true" class="main-input" id="del_id" name="id" type="text">
                        </div></div>


                    <div class="row">
                        <button type="submit" class="submit" >submit</button>
                        <button type="reset" class="submit" >clear</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<section class="cards-wrapper">
    <div class="card-grid-space" th:each="card : ${cards}">
        <div class="num" th:text="${card.id}">Id</div>
        <a class="card"
             style="--bg-img: url(https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?container=focus&resize_w=1500&url=https://codetheweb.blog/assets/img/posts/html-syntax/cover.jpg)">
            <div>
                <h1 th:text="${card.name}">Name</h1>
                <p th:text="${card.description}">Description</p>
                <p th:text="${card.color}">Color</p>
                <p th:text="${card.status}">Status</p>

                <div class="date" th:text="${card.createdAt}">Date</div>

                <div class="tags">
                    <div class="tag">
                        <button class="Btn edit-button" type="button" id="openModalBtn" data-toggle="modal" data-target="#updateCardModal" th:attr="data-card-id=${card.id}">Edit</button>
                    </div>

                    <div class="tag">
                        <button class="Btn delete-button" type="button" id="openDeleteModalBtn" data-toggle="modal" data-target="#deleteCardModal" th:attr="data-card-id=${card.id}">Del</button>
                    </div>
                </div>

            </div>
        </a>
    </div>

</section>
<!--populate the modal based on the card-->
<script>

$(document).ready(function() {
  $('.delete-button').click(function() {
      var cardId = $(this).data('card-id');
      $('#del_id').val(cardId);
      });
    $('.edit-button').click(function() {
      var cardId = $(this).data('card-id');

      $.ajax({
        url: '/get-card/' + cardId, // Adjust the URL to match your endpoint
        type: 'GET',
        success: function(card) {
          // Assuming you have a function to populate the modal with card data
          populateModal(card);
        },
        error: function() {
          // Handle error
        }
      });
    });
  });

  function populateModal(card) {
    // Populate the modal fields with card data
    $('#id').val(card.id);
    $('#name').val(card.name);
    $('#description').val(card.description);
    $('#color').val(card.color);
    $('#status').val(card.status);
    // ... Populate other fields
  }
</script>
<!-- Include jQuery and Bootstrap JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

</body>
</html>
